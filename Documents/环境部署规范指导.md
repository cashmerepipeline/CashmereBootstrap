# 环境部署规范

## 综述，策略，目标

    目标：Windows动画生产和开发软件平台
        以生产为目标：
            生产级水准稳定性
            兼顾软件的新版本和新功能的平滑迭代升级
            兼顾生产环境软件部署迭代的便利性
            开发环境和生产环境设置切换平滑一致
        
        解决痛点：
            完整的生产环境安装部署解决方案，解决软件安装设置杂乱无章无组织带来的N多设置问题
            自动化部署，极大的降低IT运维工作量和运维难度，只需运行几个脚本即可大规模部署到生产环境中
            类似Linux的开发环境，极大的方便编译和集成部署第三方库，同时提供技术支持，告别没有支持的时代
            省去IT或者开发自己搭建开发环境和编译库的大量时间和精力和测试时间，告别不能编译一个库            
            当前编译集成46个基础C++函数库和79个Python函数库，并且在不断的增长中

        自定义编译集成大量稳定的软件和库，形成稳定的运行环境和开发环境
        统一C++编译器版本，一个版本Python
            解决Python因为编译器不一致产生的不兼容问题
            解决因为编译器版本不一致导致的软件不稳定问题
        自定义编译集成了大量的C/C++基础库和运行库
        稳定的运行环境和开发环境：
            可方便构建自定义的开发运行和编译环境；
        部署简单快捷，大量节省IT运维工作量和时间

        解决windows平台软件不能统一, 针对国内的情况，本设置针对Windows平台，Linux平台以后根据需求开发

    1、工具
        powershell
        python
        git
        rez

    1、配置和软件分离
        软件配置和软件安装位置分开，rez默认为合并在一起，
        软件包安装配置可以灵活组合和部署，
        rez主要作为环境配置工具

    2、配置使用git进行版本管理和跟踪
        使用git进行配置版本管理
        使用git进行配置部署

    3、可扩展和修改容易
        包的大小和管理根据需求情况进行大小适度划分，比如将多个库组合成为一个包进行处理
        包依赖的解决通过rez require进行
        包的冲突管理

    4、多版本共存

## 软件包和库安装位置和特点说明

    本地安装位置固定为D:盘，这是根据成本和各方面使用平衡的结果，
    不建议使用C:盘作为安装位置，
        因为Windows和软件默认会将大量的缓存和设置放到C:盘
        虚拟内存页面有时需要设置的很大，需要大量占用C:盘
    X:为网络位置映射盘符，可读共享，根据情况设置读写权限

    制作软件：
        根据需要手工安装，比如Maya， Houdini等，
        版本相对稳定，升级不频繁，
        频繁被调用，需要调用稳定和速度，
        安装到本地
        路径格式：
            D:\CashmereRuntime\Applications\maya(软件名)\2018.2（版本号）\

    函数库和工具包：
        根据需要手工安装，比如cuda等，
        版本相对稳定，升级不频繁，
        频繁被调用，需要调用稳定和速度，
        安装到本地
        路径格式
            D:\CashmereRuntime\Applications\cuda(软件名)\9.1（版本号）\

    开发者工具：
        根据需要手工安装，比如vs，vscode, pycharm等，
        版本相对稳定，升级不频繁，
        频繁被调用，需要调用稳定和速度，
        只有开发人员使用，
        安装到本地
        路径格式
            D:\CashmereRuntime\DevelopTools\vscode(软件名)\1.23.0（版本号）\

    C++动态基础库安装
        版本相对稳定，升级不频繁，
        频繁被调用，需要调用稳定和速度，
        安装到本地
        路径格式
            D:\CashmereRuntime\Libraries\boost(库名)\1.61（版本号）\

    Python基础库安装
        版本相对稳定，升级不频繁，
        文件多且小，
        频繁被调用，需要调用稳定和速度，
        安装到本地
        路径格式
            D:\CashmereRuntime\PythonLibraries\tensorflow(库名)\1.7（版本号）\

    InHouse Python库
        版本不稳定，升级修改频繁，
        文件不多，
        频繁调用，
        版本需要统一，
        安装到共享服务器
        路径格式（盘符为网络路径虚拟盘符）
            X:\CashmereRuntime\InHouse\workflow(库名)\0.2.3\

## 配置部署

    版本不稳定，升级修改频繁，
    文件多，且小
    频繁调用，
    版本需要分为Production， Testing， Staging，
    统一共用设置文件，
    安装到共享服务器，
    路径格式（盘符为网络路径虚拟盘符），
        X:\CashmereRez\Staging\PythonLibraries(包分类)\workflow(库名)\0.2.3\

## powershell 启动脚本存放位置

    环境启动脚本
    软件启动脚本

    可以编写软件启动界面，亦可以直接运行脚本启动软件

    文件不多，
    频繁调用，
    版本需要统一，
    部署到共享服务器，也可以复制到用户本地，用户自定义启动环境，
    路径格式（盘符为网络路径虚拟盘符）
        X:\bootstrap\

